library(rstan)
#install.packages("gamlss.dist")
library(gamlss.dist)#for ZIP function
library(boot)#for inv.logit function
wd2<-getwd()
x=t(structure(.Data=c( 1, 0, 0.76, 4.25, 5.2, 3, 87, 0, 0, 0, 1, 0,
                       3.39, 9.15, 12.229, 5.3, 87, 0, 0, 0, 1, 0, 3.81, 9.657, 12.514,
                       6.314, 83.33, 0, 0, 0, 1, 0, 0.51, 7.464, 9.743, 4.657, 83.67, 0, 0,
                       0, 1, 0, 0, 6.029, 10.057, 0.6, 85.67, 0, 0, 0, 1, 0, 0, 6.136,
                       11.343, 0, 84.67, 0, 0, 0, 1, 0, 0.3428571, 6.55, 8.714, 4.057, 89,
                       0, 0, 0, 1, 0, 2, 1.279, 5.486, -3.457, 85, 0, 0, 0, 1, 0, 0, 8.657,
                       12.029, 4.657, 86, 0, 0, 0, 1, 0, 0.19, 10.443, 14.714, 4.886,
                       85.33429, 1, 0, 0, 1, 0, 0, 7.293, 11.571, 2.4, 88.67, 1, 0, 0, 1,
                       0, 0, 9.921, 14.371, 2.971, 77.33, 1, 0, 0, 1, 0, 2.07, 11.1, 15.6,
                       4.143, 85.67, 1, 0, 0, 1, 0, 4.6, 9.321, 14.514, 3.629, 89.33, 1, 0,
                       0, 1, 0, 0, 14.05, 17.6, 9.2, 83.33, 1, 0, 0, 1, 0, 2.057143,15.557,
                       20.086, 7.886, 80.67, 1, 0, 0, 1, 0, 0.8, 16.121, 20.571, 10.514,
                       82, 1, 0, 0, 1, 0, 0.26, 16.079, 20.029, 9.543, 83.85714, 1, 0,
                       0, 1, 0, 0.1, 15.486, 19.457, 8.886, 85, 1, 0, 0, 1, 0, 0.33,
                       16.086, 19.514, 8.629, 87.67, 1, 0, 0, 1, 0, 0, 21.221, 24.943,
                       11.2, 88, 1, 0, 0, 1, 0, 2.13, 24.357, 28.343, 14.871, 77.67, 0, 1,
                       0, 1, 0, 0.11, 21.15, 25.914, 12.771, 82.33, 0, 1, 0, 1, 0, 4.26,
                       20.664, 23.829, 13.133, 83.67, 0, 1, 0, 1, 0, 0, 21.964, 26.229,
                       13.914, 66.33, 0, 1, 0, 1, 0, 0, 25.036, 28.943, 16.086, 81.52429,
                       0, 1, 0, 1, 0, 0, 27.257, 32.543, 15.771, 73, 0, 1, 0, 1, 0, 7.04,
                       27.6, 32.4, 18, 79.67, 0, 1, 0, 1, 0, 0, 23.864, 27.514, 17.571, 78,
                       0, 1, 0, 1, 0, 0, 28.007, 32.143, 19.943, 84.67, 0, 1, 0, 1, 0,
                       0.01, 27.464, 31.771, 19.343, 81.33, 0, 1, 0, 1, 0, 0, 26.871,
                       31.543, 18.057, 75.67, 0, 1, 0, 1, 0, 1.11, 28.171, 32.771, 18.686,
                       80, 0, 1, 0, 1, 0, 1.1, 26.386, 31.086, 18.771, 78.90571, 0, 1, 0,
                       1, 0, 0, 25.05, 30, 17.114, 53.67, 0, 1, 0, 1, 0, 0, 25.521,
                       30.286, 18.257, 76.33, 0, 1, 0, 1, 0, 0, 25.329, 30.629, 17.4,
                       49.33, 0, 0, 1, 1, 0, 0.07, 25.036, 31.686, 17.171, 74.33, 0, 0, 1,
                       1, 0, 0, 23.264, 29.829, 14.457, 82, 0, 0, 1, 1, 0, 9.43, 23.571,
                       29.857, 16.114, 84.33, 0, 0, 1, 1, 0, 2.26, 20.457, 25.657, 15,
                       82.33, 0, 0, 1, 1, 0, 0.6285714, 16.721, 20.029, 13.171, 71.76, 0,
                       0, 1, 1, 0, 0.56, 15.179, 17.943, 12.571, 77.67, 0, 0, 1, 1,
                       0, 0, 15.686, 20.257, 10.571, 75, 0, 0, 1, 1, 0, 3.942857, 14.443,
                       19.371, 8.714, 76, 0, 0, 1, 1, 1, 4.73, 11.186, 14.371, 6.486, 67,
                       0, 0, 1, 1, 0, 0, 8.779, 13.057, 4.971, 58.67, 0, 0, 1, 1, 0, 0,
                       7.286, 12.2, 2.743, 68.67, 0, 0, 1, 1, 0, 0, 2.914, 8.571, -2.743,
                       70.67, 0, 0, 1, 1, 0, 1.36, 6.743, 11.429, -0.486, 70.52571, 0, 0,
                       0, 1, 0, 9.228571, 6.636, 12.257, 1.686, 67, 0, 0, 0, 1, 0, 11.8,
                       4.607, 6.829, 1.486, 66, 0, 0, 0, 1, 0, 12.07143, 7.514, 10.686,
                       5.657, 54.67, 0, 0, 0, 1, 0, 0.8714286, 3.793, 6, 2.4, 56.67, 0, 0,
                       0, 1, 0, 0, 0.471, 2.4, -1.943, 62.67, 0, 0, 0, 1, 0, 0.2857143,
                       7.657, 12.543, 2.943, 68.67, 0, 0, 0, 1, 0, 6.4, 6.357, 11.143,
                       2.543, 70.33, 0, 0, 0, 1, 0, 0.6857143, 7.686, 11.571, 3.029,
                       63.71571, 0, 0, 0, 1, 0, 0, 8.171, 11.571, 4.229, 87, 0, 0, 0, 1, 0,
                       0.5, 10.364, 15.057, 5.543, 83, 0, 0, 0, 1, 0, 3.728571, 11.486,
                       15.8, 7.571, 74, 0, 0, 0, 1, 0, 1.86, 10.479, 14, 7.143, 77.33, 1,
                       0, 0, 1, 0, 1.13, 6.55, 10.057, 2.343, 82.33, 1, 0, 0, 1, 0, 0.1,
                       8.95, 13.114, 4.2, 90.67, 1, 0, 0, 1, 0, 14, 9.529, 13.314, 5.571,
                       79.33, 1, 0, 0, 1, 0, 0, 12.95, 16.857, 6.571, 81.95143, 1, 0, 0, 1,
                       0, 4.73, 8.15, 12.8, 3.571, 77, 1, 0, 0, 1, 0, 1.16, 13.607, 17.514,
                       6.686, 85.67, 1, 0, 0, 1, 0, 1.46, 16.1, 20.257, 9.629, 85.67, 1, 0,
                       0, 1, 0, 0.8571429, 14.414, 18.886, 8.6, 80.33, 1, 0, 0, 1, 0, 0,
                       18.736, 21.8, 11.2, 83.67, 1, 0, 0, 1, 0, 0, 17.843, 21.857, 10.257,
                       52.67, 1, 0, 0, 1, 0, 0.4, 21.2, 25.371, 12.514, 51.67, 1, 0, 0, 1,
                       0, 0, 23.743, 29, 13.229, 73.81143, 0, 1, 0, 1, 0, 0.04, 23.826,
                       28.029, 16.143, 70.33, 0, 1, 0, 1, 0, 0.1, 26.736, 30.371, 17.429,
                       78.33, 0, 1, 0, 1, 0, 1.74, 25.107, 29.943, 16.6, 85, 0, 1, 0, 1, 0,
                       0.1, 24.857, 28.314, 17.657, 73.33, 0, 1, 0, 1, 0, 1.34, 26.093,
                       30.429, 17.343, 63.33, 0, 1, 0, 1, 0, 2.07, 24.707, 29.457, 17.714,
                       62, 0, 1, 0, 1, 0, 0.09, 27.171, 31.314, 20.2, 50.67, 0, 1, 0, 1, 0,
                       0, 27.829, 32.143, 19.086, 68.99857, 0, 1, 0, 1, 0, 0, 26.193,
                       29.886, 18.657, 73.33, 0, 1, 0, 1, 0, 0.76, 24.843, 29.657, 16.857,
                       75, 0, 1, 0, 1, 0, 0, 25.329, 29.4, 17.343, 88.33, 0, 1, 0, 1, 0,
                       1.31, 25.157, 29.4, 17.2, 85.67, 0, 1, 0, 1, 1, 4.27, 22.943,
                       27.157, 15.457, 80.66, 0, 1, 0, 1, 0, 0.6, 22.343, 26.114, 15.286,
                       69.33, 0, 1, 0, 1, 0, 0, 22.6, 27.229, 16.086, 76.80857, 0, 0, 1, 1,
                       0, 0, 20.436, 24.686, 14.914, 71.67, 0, 0, 1, 1, 0, 7.54, 17.6,
                       22.571, 11.2, 79.33, 0, 0, 1, 1, 0, 0, 15.15, 20.114, 8, 69, 0,
                       0, 1, 1, 0, 0, 17.293, 22.2, 11.714, 65.33, 0, 0, 1, 1, 0, 0,
                       15.557, 20.6, 9.057, 61.67, 0, 0, 1, 1, 2, 0.1, 11.943, 15, 9.371,
                       84.33, 0, 0, 1, 1, 1, 18.42857, 12.907, 17.943, 7.143, 79.33, 0, 0,
                       1, 1, 1, 3.41, 4.786, 9.829, 0.686, 72.95143, 0, 0, 1, 1, 1,
                       4.314286, 13.871, 17.086, 9.514, 78.67, 0, 0, 1, 1, 0, 0.6, 2.714,
                       7.6, -0.971, 84, 0, 0, 1, 1, 0, 2.37, 8.907, 11.514, 5.486, 57.33,
                       0, 0, 1, 1, 0, 0.57, 6.921, 8.857, 4.571, 55.33, 0, 0, 1, 1, 0,
                       0, 4.6, 7.771, 0.4, 64.67, 0, 0, 0, 1, 0, 1.8, 6.364, 9.971, 1.714,
                       72.67, 0, 0, 0, 1, 0, 4.585714, 11.757, 14.429, 9.8, 78.33, 0, 0, 0,
                       1, 0, 1.816667, 5.767, 8.6, 2.9, 70.14286, 0, 0, 0, 1, 0, 0, 6.129,
                       8.2, 2.743, 82, 0, 0, 0, 1, 0, 0, 1.764, 5.314, -0.971, 64, 0, 0, 0,
                       1, 0, 0.8857143, 3.007, 6.143, -0.457, 69.33, 0, 0, 0, 1, 0, 0.27,
                       2.136, 5.2, -0.857, 87.33, 0, 0, 0, 1, 0, 2.03, 3.193, 6.743, 0.457,
                       73.33, 0, 0, 0, 1, 0, 0.24, 4.471, 7.286, 0.914, 72.33, 0, 0, 0, 1,
                       0, 14.04, 8.686, 11.943, 5.114, 80.33, 0, 0, 0, 1, 0, 3.085714,
                       3.136, 6.543, -0.086, 75.52143, 0, 0, 0, 1, 0, 0.94, 2.129, 5.714, -
                         1.914, 82.33, 1, 0, 0, 1, 0, 0.9142857, 5.221, 7.829, 1.771, 79.67,
                       1, 0, 0, 1, 0, 1.06, 4.721, 7.571, 1.057, 64.33, 1, 0, 0, 1, 0, 2.9,
                       8.357, 11.629, 4.229, 73.67, 1, 0, 0, 1, 0, 4.428571, 12.2, 16.371,
                       7.114, 71.33, 1, 0, 0, 1, 0, 0, 10.707, 13.971, 5.057, 70.33, 1, 0,
                       0, 1, 0, 3.685714, 10.021, 13.686, 4.8, 50.67, 1, 0, 0, 1, 0, 0.03,
                       13.5, 17.971, 6.114, 70.33286, 1, 0, 0, 1, 0, 0, 18.057, 22.571,
                       12.229, 49.33, 1, 0, 0, 1, 0, 0, 21.186, 26.743, 13.343, 68.33, 1,
                       0, 0, 1, 0, 0.56, 19.35, 22.257, 13.343, 68.67, 1, 0, 0, 1, 0, 0,
                       22.514, 27.057, 15.543, 69.33, 1, 0, 0, 1, 0, 1.51, 21.329, 25.029,
                       15.543, 69, 0, 1, 0, 1, 0, 0, 23.457, 27.971, 14.4, 78, 0, 1, 0, 1,
                       0, 1.87, 25.371, 30.571, 16.286, 85.33, 0, 1, 0, 1, 0, 0, 22.743,
                       26.514, 13.829, 69.71286, 0, 1, 0, 1, 0, 0, 25.55, 29.8, 16.657,
                       83.67, 0, 1, 0, 1, 0, 0, 27.257, 31.8, 16.943, 81.67, 0, 1, 0, 1,
                       0, 0, 26.779, 30.714, 18.629, 79.33, 0, 1, 0, 1, 1, 0, 27.014,
                       31.229, 19.029, 70.67, 0, 1, 0, 1, 0, 0, 24.836, 28.571, 17.371,
                       58.33, 0, 1, 0, 1, 1, 0, 28.05, 33.029, 19, 62.33, 0, 1, 0, 1, 1,
                       0.91, 26.293, 31.057, 18.171, 64.67, 0, 1, 0, 1, 0, 0.04285714,
                       25.171, 29.543, 17.371, 71.52429, 0, 1, 0, 1, 0, 0.7, 22.707,
                       26.486, 16.543, 80, 0, 1, 0, 1, 1, 0, 24.821, 28.8, 17.486, 80, 0,
                       1, 0, 1, 1, 0.5714286, 21.85, 25.971, 15.8, 73.33, 0, 1, 0, 1, 2,
                       1.59, 19.921, 23.743, 13.4, 52.67, 0, 0, 1, 1, 2, 0, 17.993, 22.657,
                       12, 72.67, 0, 0, 1, 1, 5, 1.971429, 19.936, 23.829, 14.714, 66.67,
                       0, 0, 1, 1, 10, 0, 17.05, 20.886, 12.857, 61, 0, 0, 1, 1, 6, 0.41,
                       16.414, 19.314, 12.857, 69.47714, 0, 0, 1, 1, 8, 0, 15.214, 20.114,
                       9.171, 59.33, 0, 0, 1, 1, 4, 0, 12.586, 17.057, 5.971, 80.67, 0, 0,
                       1, 1, 7, 2.19, 11.293, 16.486, 5.371, 61.33, 0, 0, 1, 1, 6, 0,
                       11.829, 18.171, 4.629, 60, 0, 0, 1, 1, 8, 0, 9.207, 13.6, 4.829,
                       67.67, 0, 0, 1, 1, 11, 2.54, 13.586, 16.486, 8.257, 75, 0, 0, 1, 1,
                       8, 14.25714, 12.471, 15.771, 8.943, 75.33, 0, 0, 1, 1, 2, 6.31,
                       10.821, 12.914, 9.229, 68.47571, 0, 0, 1, 1, 3, 0, 9, 11.343, 5.629,
                       69.33, 0, 0, 0, 1, 2, 0.7285714, 10.771, 14.4, 7.286, 68.33, 0, 0,
                       0, 1, 4, 2.557143, 5.971, 9.629, 3.629, 66.33, 0, 0, 0, 1, 2, 0,
                       8.575, 11.6, 3.85, 68.33, 0, 0, 0, 1, 0, 3.928571, 7.764, 10.029,
                       5.171, 54.67, 0, 0, 0, 1, 0, 0.37, 4.264, 8.114, 1.2, 67.33, 0, 0,
                       0, 1, 1, 0, 5.543, 10, 0.371, 66.67, 0, 0, 0, 1, 0, 0, 2.529, 7.971,
                       -2.857, 65.85571, 0, 0, 0, 1, 0, 0, 2.121, 7.343, -2.471, 67.67, 0,
                       0, 0, 1, 0, 0, 7.329, 12.771, 0.429, 55.67, 0, 0, 0, 1, 0, 0.39, 5,
                       9.143, 0.629, 64, 0, 0, 0, 1, 0, 1.19, 7.85, 11.971, 4.114, 75.33,
                       0, 0, 0, 1, 0, 0.3571429, 7.686, 12.429, 1.571, 64, 1, 0, 0, 1, 0,
                       0.06, 7.064, 12.114, 1.371, 61.33, 1, 0, 0, 1, 0, 1.5, 7.321,
                       11.229, 3.086, 48.67, 1, 0, 0, 1, 0, 0.04, 6.007, 9.629, 0.829,
                       62.38143, 1, 0, 0, 1, 0, 7.642857, 9.036, 12.771, 5.914, 57.67, 1,
                       0, 0, 1, 0, 0, 8.107, 11.314, 2.6, 59.67, 1, 0, 0, 1, 0, 4.76,
                       8.414, 11.829, 2.857, 68.33, 1, 0, 0, 1, 0, 0.84, 12.979, 15.743,
                       8.829, 56.33, 1, 0, 0, 1, 0, 0.6571429, 13.607, 17.486, 7.771,
                       65.67, 1, 0, 0, 1, 0, 0, 18.143, 22.143, 11.857, 63.67, 1, 0, 0, 1,
                       0, 0, 22.421, 27.2, 14, 59, 1, 0, 0, 1, 0, 0.53, 21.557, 26.6,
                       12.886, 61.47714, 1, 0, 0, 1, 0, 1.157143, 16.736, 19.857, 11.314,
                       74.67, 1, 0, 0, 1, 0, 0.1571429, 19.429, 23.171, 11.857, 54, 0, 1,
                       0, 1, 0, 2.76, 22.364, 25.286, 15.371, 57.67, 0, 1, 0, 1, 0, 0,
                       26.607, 30.057, 18.114, 61.67, 0, 1, 0, 1, 0, 0, 26.714, 31.714,
                       18.257, 64.67, 0, 1, 0, 1, 0, 0, 28.043, 32.086, 18.057, 65, 0, 1,
                       0, 1, 0, 0.1, 26.179, 29.371, 18.829, 56.67, 0, 1, 0, 1, 0, 1.3,
                       23.686, 27.343, 15.343, 62.05, 0, 1, 0, 1, 0, 0, 26.479, 31.486,
                       18.914, 56.33, 0, 1, 0, 1, 0, 1.01, 25.986, 31.2, 18.486, 67, 0, 1,
                       0, 1, 1, 5.714286, 24.521, 29.286, 16.943, 58.67, 0, 1, 0, 1, 0,
                       0.4428571, 22.921, 28.2, 16.086, 81, 0, 1, 0, 1, 2, 0, 23.157,
                       28.714, 16.2, 69, 0, 1, 0, 1, 1, 0.7857143, 22.643, 27.114, 10.1,
                       62.67, 0, 1, 0, 1, 1, 0, 20.821, 26.371, 12, 67.67, 0, 1, 0, 1, 7,
                       0, 19.936, 26.343, 11.243, 66.04857, 0, 1, 0, 1, 3, 0, 19.964,
                       25.657, 11.229, 66, 0, 0, 1, 1, 3, 0, 16.593, 22.286, 8.4, 69.67, 0,
                       0, 1, 1, 3, 2.685714, 16.943, 23.886, 9.829, 52, 0, 0, 1, 1, 2, 0,
                       16.914, 23.686, 6.357, 35, 0, 0, 1, 1, 3, 2.04, 16.236, 20.557,
                       9.214, 49.67, 0, 0, 1, 1, 0, 5.771429, 11.164, 18.457, 5.243, 53.33,
                       0, 0, 1, 1, 3, 0, 8.086, 12.4, 3.886, 58.33, 0, 0, 1, 1, 1, 0,
                       9.786, 15.029, 3.386, 54.85714, 0, 0, 1, 1, 1, 3.285714, 14.621,
                       20.114, 11.543, 43, 0, 0, 1, 1, 0, 11.74, 8.086, 11.914, 5.6, 45.67,
                       0, 0, 1, 1, 1, 0, 10.836, 14.286, 7.6, 52.33, 0, 0, 1, 1, 1,
                       4.157143, 11.35, 14.8, 6.714, 51, 0, 0, 1, 1, 1, 5.371429, 5.807,
                       9.6, 1.071, 40, 0, 0, 0, 1, 1, 2.41, 0.957, 6.6, -2.857, 38.67, 0,
                       0, 0, 1, 2, 2.86, 8.064, 12.286, 2.857, 37.33, 0, 0, 0, 1, 0,
                       7.75, 6.45, 11, 0.733, 44, 0, 0, 0, 1, 0, 0, 6.857, 11.429, 2.143,
                       46.67, 0, 0, 0, 1, 0, 0.01, 6.586, 10.457, 2.114, 53.33, 0, 0, 0, 1,
                       0, 5.53, 7.15, 10, 4.371, 52.67, 0, 0, 0, 1, 0, 0, 1.564, 4.914, -
                         2.314, 46.67, 0, 0, 0, 1, 0, 11.81, 4.571, 7.229, 1.314, 54.33, 0,
                       0, 0, 1, 0, 0, 5.529, 10.029, 0.429, 58.67, 0, 0, 0, 1, 0, 0.24,
                       7.793, 13.257, 2.343, 55.67, 0, 0, 0, 1, 0, 0, 7.914, 14.229, 2.286,
                       52.57286, 0, 0, 0, 1, 0, 0, 8.986, 14.029, 1.386, 63.33, 1, 0, 0, 1,
                       0, 9.1, 6.686, 12.914, 0.929, 65.33, 1, 0, 0, 1, 0, 1.057143,
                       4.929, 9.557, 0.657, 79, 1, 0, 0, 1, 0, 0.33, 3.807, 6.743, 0.643,
                       73, 1, 0, 0, 1, 0, 0.04, 9.243, 13.957, 3.2, 61.67, 1, 0, 0, 1, 0,
                       0, 16.807, 20.3, 7.929, 51.33, 1, 0, 0, 1, 0, 0, 15.986, 20.029,
                       8.471, 41.67, 1, 0, 0, 1, 0, 0.24, 13.414, 16.829, 7.771, 62.19, 1,
                       0, 0, 1, 0, 0.43, 16.271, 19.457, 10.886, 37, 1, 0, 0, 1, 0,
                       0.2571429, 19.071, 23.343, 14.057, 42, 1, 0, 0, 1, 0, 3.2, 16.714,
                       19.686, 13.143, 53, 1, 0, 0, 1, 0, 5.242857, 16.621, 19.143, 12.829,
                       52, 1, 0, 0, 1, 0, 2.23, 20.443, 23.543, 14.314, 47.67, 1, 0, 0, 1,
                       0, 3.87, 22.479, 26.057, 15.429, 46.67, 0, 1, 0, 1, 0, 0, 24.007,
                       26.857, 17.571, 44.33, 0, 1, 0, 1, 0, 0.27, 23.557, 26.914, 15.571,
                       46.09571, 0, 1, 0, 1, 0, 0.04285714, 25.229, 28.771, 16.229, 40.33,
                       0, 1, 0, 1, 0, 1.614286, 26.9, 31.8, 19.257, 42.67, 0, 1, 0, 1,
                       0,2.56, 22.371, 26.657, 15.343, 33.67, 0, 1, 0, 1, 1, 0, 26.593,
                       30.571, 17.029, 35, 0, 1, 0, 1, 1, 0, 29.436, 34.029, 21.257,
                       39.33, 0, 1, 0, 1, 1, 0, 30.4, 35.971, 20.943, 38, 0, 1, 0, 1, 0, 0,
                       31.771, 36.457, 22.686, 38.33, 0, 1, 0, 1, 0, 0, 26.8, 31.6, 18.914,
                       38.19, 0, 1, 0, 1, 0, 0, 25.8, 30.371, 18.686, 34, 0, 1, 0, 1, 0, 0,
                       25.929, 29.857, 18.886, 40.67, 0, 1, 0, 1, 1, 0, 22.814, 26.771,
                       16.029, 45, 0, 1, 0, 1, 0, 0, 23.514, 27.629, 17.371, 56.67, 0, 0,
                       1, 1, 0, 0.1428571, 20.3, 24.857, 14.286, 53, 0, 0, 1, 1, 0, 3.67,
                       17.679, 21.371, 13.114, 39.67, 0, 0, 1, 1, 1, 4.79, 20.064, 23.8,
                       14.743, 47, 0, 0, 1, 1, 1, 2.36, 19.171, 23.8, 13.343, 45.14429, 0,
                       0, 1, 1, 0, 3.01, 16.943, 21.714, 12.714, 39.67, 0, 0, 1, 1, 1, 0,
                       15.421, 19.771, 9.857, 53, 0, 0, 1, 1, 0, 8.728571, 13.864, 17.971,
                       9.6, 46, 0, 0, 1, 1, 0, 0, 15.779, 19.457, 11.4, 49, 0, 0, 1, 1, 0,
                       6.014286, 9.386, 13.686, 5.343, 48, 0, 0, 1, 1, 1, 4.242857, 7.229,
                       11.029, 3.686, 55.33, 0, 0, 1, 1, 0, 3.457143, 9.286, 10.914, 7.457,
                       37, 0, 0, 1, 1, 1, 4.528571, 5.943, 7.829, 2.971, 46.85714, 0, 0, 1,
                       1, 0, 2.3, 2.771, 9.2, 0.514, 43.33, 0, 0, 0, 1, 0, 0.29, 4.5, 7.2,
                       1.314, 52, 0, 0, 0, 1, 0, 3.63, 3.557, 7.143, 0.343, 50.33, 0, 0,
                       0), .Dim = c(10,260)))
#startind variable#
startinds = c( 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
               16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32,
               33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49,
               50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66,
               67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83,
               84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 98, 99, 100, 101,
               102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114,
               115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127,
               128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140,
               141, 142, 144, 145, 152, 197, 255, 302, 334, 354, 408, 503, 591,
               669, 685, 691, 697, 705, 713, 715, 716, 717, 718, 719, 720, 721,
               722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734,
               735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747,
               749, 750, 757, 776, 785, 793, 799, 805, 806, 807, 809, 810, 811,
               812, 813, 814, 815, 817, 818, 819, 820, 821, 822, 823, 824, 825,
               826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838,
               839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850,
               851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863,
               864, 865, 866, 867, 868, 869)
#endind variable#
endinds = c( 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
             16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32,
             33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49,
             50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66,
             67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83,
             84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 97, 98, 99, 100, 101,
             102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113,
             114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126,
             127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139,
             140, 141, 143, 144, 151, 196, 254, 301, 333, 353, 407, 502, 590,
             668, 684, 690, 696, 704, 712, 714, 715, 716, 717, 718, 719, 720,
             721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732,
             733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745,
             746, 748, 749, 756, 775, 784, 792, 798, 804, 805, 806, 808, 809,
             810, 811, 812, 813, 814, 816, 817, 818, 819, 820, 821, 822, 823,
             824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836,
             837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848,
             849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861,
             862, 863, 864, 865, 866, 867, 868, 869)
x10<-c( 250, 250, 250, 250, 250, 250, 250, 250, 250, 250,
        250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250,
        250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250,
        250, 250, 250, 250, 250, 250, 250, 250, 1, 250, 250, 250, 250, 250,
        250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250,
        250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250,
        250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 1, 250, 250,
        250, 250, 250, 250, 250, 1, 20.31, 18.68, 8.383, 9.022, 20.52, 250,
        250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250,
        250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250,
        250, 250, 250, 250, 250, 250, 250, 1, 250, 1, 20.6, 250, 250, 1,
        12.74, 17.42, 18.62, 11.83, 4.117, 6.24, 11.83, 4.073,
        8.228, 9.884, 2.021, 10.39, 4.117, 10.51, 8.918, 8.761, 6.145,
        11.89, 17.63, 14.2, 27.3, 18.06, 6.24, 2.563, 4.844, 10.06, 16.57,
        23.19, 21.32, 31.6, 11.83, 18.68, 18.06, 15.4, 15.6, 19, 22.47,
        17.36, 32.44, 7.074, 4.695, 8.94, 15.38, 21.47, 18.29, 30.91, 18.62,
        30.03, 37.07, 36.11, 33.96, 30.52, 30.18, 29.41, 24.5, 37.03, 28.77,
        20.77, 20.37, 18.03, 22.53, 13.21, 11.7, 15.23, 18.15,
        18.23, 80.89, 72.16, 69.33, 67.71, 72.56, 65.35, 62.66, 62.49,
        67.48, 56.26, 18.08, 6.25, 2.57, 4.85, 10.07, 16.58, 23.21, 21.34,
        31.63, 9.03, 20.54, 27.04, 26.76, 23.47, 24.48, 27.02, 29.21, 23.8,
        38.76, 11.84, 7.08, 6.25, 4.7, 8.95, 15.4, 21.49, 18.31, 30.95,
        15.81, 27.25, 34.29, 33.35, 31.17, 27.96, 27.95, 27.64, 22.55,
        35.71, 39.54, 20.66, 27.95, 44.41, 36.14, 13.21, 22.53, 27.57,
        90.03, 32.43, 25.28, 93.22, 17.98, 65.35, 72.56, 79.16, 33.35,
        38.03, 42.5, 40.33, 50.4, 10.07, 4.85, 20.84, 10.65, 57.33, 65.38,
        18.22, 73.56, 24.48, 23.47, 10.82, 27.25, 41.4, 47.17, 34.39, 55.22,
        8.95, 4.7, 15, 57.6, 67.19, 7.74, 75.32, 27.96, 31.17, 12.8, 17.11,
        41.23, 51.68, 19.79, 59.64, 17.68, 27.32, 11.77, 19.45, 40.93,
        49.07, 25.75, 57.26, 10.93, 14.8, 6.72, 18.94, 38.67, 48.52, 22.98,
        56.59, 2.96, 23.08, 10.13, 29.96, 30.72, 38.21, 35.54, 46.4, 13.29,
        14.93, 17.55, 60.03, 63.07, 27.32, 7.24, 21.1, 56.9, 61.45, 14.8,
        9.84, 8.51, 56.77, 60.25, 23.08, 3.61, 17.25, 45.99, 50.69, 14.93,
        11.26, 13.53, 57.44, 8.76, 9.02, 18.55, 12.94, 8.46, 53.95, 62.93,
        5.64, 11.13, 10.68, 5.25, 12.77, 59.17, 7.23, 55.63, 49.35, 70.49,
        65.35, 47.34, 8.77, 17.84, 51.18, 45.67, 65.47, 61.39, 44.94, 14.22,
        58.09, 51.91, 73, 68.11, 50.22, 4.43, 64.15, 59.19, 38.21, 49.19,
        69.09, 61.83, 29.91, 55.27, 15.41, 29.83, 85.4, 4.85, 17.38, 8.09,
        75.63, 21.34, 8.39, 23.91, 86.58, 9.76, 70.92, 74.17, 57.97,
        87.6, 69.09, 17.92, 2.41, 56.55, 91.12, 60.99, 66.32, 51.15, 75.63,
        61.83, 6.05, 18.53, 50.78, 78.31, 22.57, 25.79, 37.71, 5.25, 29.91,
        76.26, 88.96, 40.47, 58.88, 60.51, 44.5, 76.47, 55.27, 23.23, 17.64,
        42.5, 80.62, 65.58, 68.11, 51.91, 82.76, 62.93, 19.2, 8.36, 50.22,
        86.58, 9.36, 10.24, 6.29, 26.99, 5.64, 52.41, 62.14, 8.72, 31.84,
        15.15, 16.22, 33.01, 11.13, 47.01, 56.15, 3, 37.71, 9.51, 5.61,
        21.15, 15.4, 10.68, 66.57, 76.92, 23.22, 20.65, 8.72, 16.22,
        20.56, 5.25, 62.6, 72.32, 18.01, 25.79, 17.91, 18.01, 3, 35.69,
        12.77, 46.37, 54.8, 40.47, 61.52, 64.3, 48.09, 78.58, 59.17, 15.82,
        9.29, 46.52, 82.35, 13.29, 9.36, 17.19, 12.73, 55.02, 10.95, 9.34,
        9.3, 16.93, 15.7, 8.72, 10.24, 21.56, 15.03, 57.48, 14.48, 10.82,
        5.25, 12.94, 28.31, 15.15, 6.29, 32.24, 27.72, 41.28, 5.18, 23.91,
        11.13, 9.02, 4.91, 17.88, 26.99, 4.09, 5.57, 72.3, 28.74, 9.8,
        33.07, 24.78, 19.87, 9.3, 5.64, 25.17, 19.21, 52.31, 10.3, 15, 8.3,
        69.83, 57.83, 52.41, 70.54, 69.46, 17.4, 48.17, 66.95, 54.69, 57.91,
        81.64, 68.91, 62.14, 83.15, 81.2, 16.14, 58.44, 78.24, 62.51, 67.28,
        30.94, 17.91, 8.72, 35.07, 30.33, 39.61, 8.18, 26.42, 8.46, 12.77,
        10.1, 22.57, 31.84, 5.83, 10.77, 76.22, 33.23, 15, 38.21, 29.91,
        6.89, 7.84, 17.2, 9.39, 6.58, 61.65, 18.3, 5.87, 24.47, 16.4, 12.26,
        3.11, 10.02, 17.14, 11.63, 56.92, 12.72, 7.68, 16.29, 8.1, 28.16,
        16.93, 8.76, 33.42, 27.5, 46.95, 12.11, 23.28, 8.3, 37.33,
        24.12, 16.69, 40.19, 36.81, 30.97, 13.24, 33.4, 18.61, 21.92, 65.51,
        53.29, 47.61, 66.48, 65.12, 14.46, 43.44, 62.49, 53.07, 49.7, 68.12,
        55.02, 47.47, 70.4, 67.63, 44.2, 64.33, 46.95, 52.31, 19.98, 7.19,
        2.24, 24.34, 19.38, 49.46, 5.82, 15.48, 10.24, 4.91, 10.72, 9.51,
        14.9, 16.98, 10.06, 62.37, 18.52, 6.14, 18.55, 10.68, 61.87, 57.6,
        48.6, 31.76, 10.8, 3.99, 50.34, 63.27, 41.19, 42.38, 45.53, 30.22,
        28.74, 40.33, 39.2, 48.78, 55.54, 63.27, 68.47, 39.3, 48.78,
        47.74, 8.72, 66.85, 5.61, 74.4, 15.7, 79.85, 47, 21.56, 8.72, 72.71,
        47.6, 81.83, 66.85, 10.29, 43.28, 76.52, 61.52, 12.03, 38.83, 26.54,
        9.36, 62.48, 50.8, 4.71, 250, 1, 250, 250, 250, 250, 250, 250, 250,
        250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250,
        250, 250, 250, 250, 250, 250, 250, 1, 250, 1, 2.27, 5.84, 0, 18.55,
        5.75, 35.87, 26.88, 3.51, 8.46, 11.6, 18.95, 50.07, 39.5, 16, 23.22,
        24.48, 5.61, 13.69, 45.41, 35.09, 10.47, 18.01, 19.62, 16, 4.14,
        36.14, 26.5, 8.19, 10.71, 10.68, 39.5, 23.22, 5.25, 35.09, 18.01,
        5.36, 26.5, 8.19, 60.11, 30.21, 10.68, 33.16, 39.5, 47.34, 18.5,
        23.22, 52.78, 20.99, 18.52, 55.22, 26.5, 16, 14.06, 14.48, 30.2,
        7.56, 10.47, 37.99, 250, 1, 5.61, 10.47, 10.47, 250, 1, 0, 65.35,
        71.71, 11.23, 11.27, 250, 250, 250, 250, 250, 250, 250, 250, 250,
        250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250,
        250, 250, 250, 250, 250, 250, 1, 250, 1, 250, 250, 250, 250, 1, 250,
        250, 250, 1, 3.49, 250, 1, 250, 250, 250, 1, 250, 1, 250, 250, 250,
        250)
O <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0,
       0, 0, 0, 3, 3, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 2, 3, 0,
       0, 2, 1, 2, 4, 8, 13, 8, 10, 5, 5, 15, 16, 15, 8, 2, 3, 3, 5, 4, 0,
       0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 2, 3, 3, 9, 5, 4, 3, 3, 5, 0, 3, 1,
       2, 0, 2, 2, 1, 1, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 10, 0, 0, 0, 0, 2, 0, 0,
       0, 8, 6, 0, 14, 0, 0, 0, 4, 0, 2, 0, 0, 0, 0)
#random effect with year
y<-c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
      2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
      2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3,
      3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
      3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4,
      4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
      4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
      4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
      5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
      5, 5, 5, 5, 5, 5, 5, 5, 5, 5)

x<-x[,-1]
inv_xtx<-solve(t(x)%*%x)#variance matrix used in g prior inside the model (passed in stan as data )
n<-260
data_stan <- list("x","n","O","y",'inv_xtx')
inlist<-function(){list(theta=1,gam=0,tau.btw=1, b=c(0,0,0,0,0,0,0,0,0),c=c(0,0,0,0,0,0,0,0,0),K=0.5,s=0)}
param<-c('b','c','random','gam','phi','U','s','OU_sd')
zipmodel <- stan_model(file="model poisson OU.stan",model_name='zip stan',  verbose=T)


zip_stan<-sampling(zipmodel, data=data_stan,init=inlist,pars=param,iter=15000,thin=10,warmup=5000,chains=3,control=list(adapt_delta=0.8))
 save(zip_stan, file="zipmodelstan")
load(file="zipmodelstan", envir = parent.frame(), verbose = FALSE)
coeff<-summary(zip_stan)$summary

b<-coeff[1:9] 
c<-coeff[10:18]
random<-coeff[19:23]
gam<-coeff[24]
phi<-coeff[25]
U<-coeff[26]
s<-coeff[27]

inlist2<-function(){list(theta=1,gam=0,tau.btw=1, b=b,c=c,K=0.5,s=0)}


#__________prequential analysis________
zipmodel_pa<- stan_model(file="zip stan preq.stan",model_name='zip stan preq analysis',  verbose=T)



#stan_sums<-list()
#O_hat_stan<-list()

#started from 225
#start from 253
for(i in 258:259){
  print(i)

#transform the data


  n_pa<-i
  x_pa<-x[1:i,]
  O_pa<-O[1:i]
  y_pa<-y[1:i]
  inv_xtx_pa<-solve(t(x_pa)%*%x_pa)#variance matrix used in g prior inside the model (passed in stan as data )

data_stan_pa<- list("x_pa","n_pa","O_pa","y_pa",'inv_xtx_pa')
param_pa<-c('b','c','random','gam','phi','U','s','lambda')
if(i==225){
  
  inlist2<-function(){list(theta=1,gam=0,tau.btw=1, b=c(0,0,0,0,0,0,0,0,0),c=c(0,0,0,0,0,0,0,0,0),K=0.5,s=0)}
}else{
  inlist2<-function(){list(theta=1,gam=gam,tau.btw=1, b=b,c=c,K=0.5,s=s,random=random)}
}
  
zip_stan_pa<-sampling(zipmodel_pa, data=data_stan_pa,init=inlist2,pars=param_pa,control=list(adapt_delta=0.8),chains=3,iter=15000,thin=10,warmup=5000)


stan_sums[[i-224]]<-summary(zip_stan_pa)$summary

b<-stan_sums[[i-224]][1:9] 
c<-stan_sums[[i-224]][10:18]
random<-stan_sums[[i-224]][19:23]
gam<-stan_sums[[i-224]][24]
s<-stan_sums[[i-224]][27]

}



save(stan_sums, file="stan_sums") 




stan_mod_params<-list('lambda'=NULL,'prop zero'=NULL,'O_hat'=NULL,'CDF'=NULL,'pmf'=NULL)


for(i in 1:length(stan_sums)){
  b<-stan_sums[[i]][1:9] 
  c<-stan_sums[[i]][10:18]
  random<-stan_sums[[i]][19:23]
  gam<-stan_sums[[i]][24]
  s<-stan_sums[[i]][27]
  phi<-stan_sums[[i]]['phi',1]
  lambda_name<-paste('lambda[',i+224,']',sep='')
  lambda_prev<-stan_sums[[i]][lambda_name,1]
  
  C<-s +b%*%x[i+225,]+random[y[i+225]]+gam*O[i+224]
 
  M<-C+(lambda_prev-C)*exp(-phi)
  
  p<-inv.logit(s +c%*%x[i+225,])
  stan_mod_params[['lambda']][i]<-exp(M)
  stan_mod_params[['prop zero']][i]<-p
  stan_mod_params[['O_hat']][i]<-(1-p)*exp(M)
  stan_mod_params[['CDF']][i]<-pZIP(O[i+225],exp(M),p)
  stan_mod_params[['pmf']][i]<-dZIP(O[i+225],exp(M),p)
}

save(stan_mod_params, file="stan_mod_params") 











log_p_stan<-sum(-log(stan_mod_params[['pmf']]))
  

mse_stan<-0
for (i in 1:35){
  mse_stan=mse_stan+(stan_mod_params[['O_hat']][i]-O[225+i])^2

}


mae_stan<-0
for (i in 1:35){
  mae_stan=mae_stan+abs(stan_mod_params[['O_hat']][i]-O[225+i])
  
}
check_positive<-function(x){if(x>0){return(1)} else{return(0)}}

rps_stan<-0
for (i in 1:35){
  rps_stan=rps_stan+(stan_mod_params[['CDF']][i]-check_positive(O[225+i]-stan_mod_params[['O_hat']][i]))
}
